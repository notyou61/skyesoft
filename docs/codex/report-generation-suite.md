# 📑 Report Generation Suite

## 🎯 Purpose  
Provide a standardized framework for creating, validating, and rendering reports across Skyesoft, using CRUD JSON, AI templates, and automation hooks. Ensures consistency in headers, body, and footers while supporting both standardized and custom reports.

## 📌 Key Features  
- Dynamic CRUD JSON generation via Skyebot prompts  
- Validation of required fields against `report_types.json`  
- Conditional auto-fill from APIs (parcel, jurisdiction, etc.)  
- Standardized templates for zoning, sign ordinance, photo survey, etc.  
- Custom/freeform report option for ad-hoc needs  

## ⚙️ Workflow  
1. **Prompt** → Skyebot determines `reportType` via CRUD JSON  
2. **Validation** → Required fields checked from `report_types.json`  
3. **Auto-fill** → Pull missing fields from APIs (parcel, SSE, codex)  
4. **Template Merge** → Apply header, body, footer per `reportType`  
5. **Render** → Output as HTML/PDF with Christy Signs branding  

---

## 📊 Report Types (Detailed Specs)

### 🟢 Zoning Report  
**Purpose**: Verify zoning status for a project site.  

**Required Fields**:  
- Mandatory: `streetNumber`, `zip`  
- Optional: `city`, `county`, `parcelId`  

**Pipeline**:  
1. Geocode via Census (fallback Google).  
2. Lookup parcel via Assessor API.  
3. Retrieve jurisdiction + geometry.  
4. Perform zoning lookup (jurisdiction-specific endpoint).  
5. Return zoning code + attributes.  

**Outputs**:  
- address  
- matchedAddress  
- county, FIPS  
- apn, situs, jurisdiction  
- zoningCodes  
- disclaimers (based on context)  

**Edge Cases**:  
- Multiple parcels → flag as `multipleParcels`  
- No geometry → fallback to geocode centroid  

---

### 🟡 Sign Ordinance Report  
**Purpose**: Summarize applicable sign regulations for a site.  

**Required Fields**:  
- Mandatory: `address`  
- Optional: `jurisdiction`, `parcelId`  

**Pipeline**:  
1. Geocode + jurisdiction detection.  
2. Query local sign code references.  
3. Return rules on size, height, lighting, materials.  

**Outputs**:  
- jurisdiction  
- signCodeSummary  
- linksToMunicipalCode  

---

### 🟡 Photo Survey Report  
**Purpose**: Collect and display site survey photos with context.  

**Required Fields**:  
- Mandatory: `address`, `photos`  
- Optional: `notes`  

**Pipeline**:  
1. Validate uploaded images.  
2. Tag photos with GPS/time.  
3. Generate structured report with captions.  

**Outputs**:  
- photoArray  
- captions  
- surveyNotes  

---

### 🟢 Custom Report  
**Purpose**: Freeform narrative or ad-hoc report generated by AI.  

**Required Fields**:  
- Mandatory: `details`  
- Optional: `title`, `context`  

**Pipeline**:  
1. Parse freeform details from prompt.  
2. Generate structured narrative (header/body/footer).  
3. Return JSON + HTML/PDF with disclaimers.  

**Outputs**:  
- reportBody  
- disclaimers  

---

## 🧠 Smart Behaviors  
- Infers context from prompt to auto-choose reportType  
- Requests clarification if multiple types are possible  
- Normalizes project identifiers (e.g., projectName vs. jobsiteName)  
- Preserves extra user-provided fields without filtering  

## 🔌 Integration Points  
- Core Database (entities, locations, contacts)  
- Permit Management Suite  
- Mobile-First Modals  
- Skyebot AI Engine  

## 🏁 Example Report Request  
```json
{
  "actionType": "Create",
  "actionName": "Report",
  "details": {
    "reportType": "zoning",
    "title": "Zoning Report – Christy Signs HQ",
    "data": {
      "projectName": "Christy Signs HQ",
      "address": "3145 N 33rd Ave, Phoenix, AZ 85017",
      "parcel": "108-03-009E",
      "jurisdiction": "Phoenix"
    }
  }
}
```