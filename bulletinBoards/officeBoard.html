<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Office Electronic Bulletin Board</title>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    html, body {
      height: 100vh;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: #f2f2f2;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    .board-section {
      width: 90vw;
      max-width: 1200px;
      background: #fff;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      padding: 8px 16px;
    }
    #pageHeader, #pageFooter {
      flex-shrink: 0;
    }
    #pageBody {
      flex-grow: 1;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      margin: 12px 0;
    }
    #pageHeader {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 1.1em;
      margin-top: 12px;
    }
    #bodyHeader, #bodyFooter {
      font-weight: bold;
      font-size: 1em;
      text-align: left;
      margin-bottom: 8px;
    }
    #bodyMain {
      flex-grow: 1;
      display: flex;
      flex-direction: column;
      justify-content: flex-start;
    }
    .entry {
      margin: 6px 0;
      font-size: 1.2em;
    }
    #pageFooter {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 0.8em;
      padding: 6px 12px;
      background: #ffffff;
      margin-bottom: 12px;
    }
  </style>
</head>
<body>
  <div class="board-section" id="pageHeader">
    <div style="display: flex; align-items: center; gap: 16px;">
      <img alt="Christy Signs" src="/skyesoft/assets/images/christyLogo.png" style="max-height: 48px;" />
      <h1 style="font-size: 1.4em; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">
        Office Electronic Bulletin Board
      </h1>
    </div>
    <div style="display: flex; flex-direction: column; align-items: flex-end; font-size: 0.9em; white-space: nowrap;">
      <div>üå¶Ô∏è Weather: <span id="weatherDisplay">Loading...</span></div>
      <div>‚è∞ Time: <span id="currentTime">--:--:--</span></div>
      <div>üïí Interval Remaining: <span id="intervalRemainingData">--</span></div>
    </div>
  </div>

  <div class="board-section" id="pageBody">
    <div id="bodyHeader"></div>
    <div id="bodyMain"></div>
    <div id="bodyFooter"></div>
  </div>

  <div class="board-section" id="pageFooter">
    <div>¬© 2025 MayChrist Corporation</div>
    <div class="version">v2025.05.05.1100a</div>
  </div>

  <script>
    const cards = [
      {
        header: "<h2>üìã Active Permits</h2>",
        body: "",
        footer: "",
        onShow: showPermitCard
      },
      {
        header: "<h2>üìà KPI Dashboard</h2>",
        body: `
          <div class='entry'>üõ†Ô∏è Open Tasks: 12</div>
          <div class='entry'>‚úÖ Completed Today: 47</div>
          <div class='entry'>üì¶ Orders Shipped: 19</div>
        `,
        footer: "<small>Updated hourly</small>"
      },
      {
        header: "<h2>üì¢ Announcements</h2>",
        body: `
          <ul>
            <li>Team meeting today at 3PM</li>
            <li>New hire orientation on Friday</li>
            <li>Submit timesheets by 4PM</li>
          </ul>
        `,
        footer: ""
      }
    ];

    let currentCardIndex = 0;
    let cardTimeout;

    function rotateCards() {
      clearTimeout(cardTimeout);
      const card = cards[currentCardIndex];

      const bodyHeader = document.getElementById("bodyHeader");
      const bodyMain = document.getElementById("bodyMain");
      const bodyFooter = document.getElementById("bodyFooter");

      if (bodyHeader) bodyHeader.innerHTML = card.header || "";
      if (bodyMain) bodyMain.innerHTML = card.body || "";
      if (bodyFooter) bodyFooter.innerHTML = card.footer || "";

      if (typeof card.onShow === "function") card.onShow();

      const duration = currentCardIndex === 0 ? 60000 : 15000;
      currentCardIndex = (currentCardIndex + 1) % cards.length;
      cardTimeout = setTimeout(rotateCards, duration);
    }

    function showPermitCard() {
      const bodyMain = document.getElementById("bodyMain");
      const bodyHeader = document.getElementById("bodyHeader");
      const bodyFooter = document.getElementById("bodyFooter");

      fetch("/skyesoft/assets/data/major_card_data.json")
        .then(res => res.json())
        .then(data => {
          const permits = data.majorCard.permits;
          if (bodyHeader) bodyHeader.innerHTML = "<h2>" + data.majorCard.title + "</h2>";
          if (bodyFooter) bodyFooter.innerHTML = "<small>Showing " + permits.length + " permits</small>";

          bodyMain.innerHTML = \`
            <div id="scrollViewport" style="position: relative; height: 100%; overflow: hidden;">
              <div id="scrollContent" style="position: absolute; top: 0; left: 0; right: 0; display: flex; flex-direction: column; gap: 6px;"></div>
            </div>
          \`;

          const scrollContent = document.getElementById("scrollContent");
          permits.forEach(p => {
            const div = document.createElement("div");
            div.className = "entry";
            div.textContent = \`\${p.WO} ‚Ä¢ \${p.Customer} ‚Ä¢ \${p.Jurisdiction} ‚Ä¢ \${p.FeeDue} ‚Ä¢ \${p.Status}\`;
            scrollContent.appendChild(div);
          });

          const scrollViewport = document.getElementById("scrollViewport");
          const maxScroll = scrollContent.scrollHeight - scrollViewport.clientHeight;
          const duration = 60000;
          const startTime = performance.now();

          function scrollStep(currentTime) {
            const elapsed = currentTime - startTime;
            const progress = Math.min(elapsed / duration, 1);
            const offset = progress * maxScroll;
            scrollContent.style.top = \`-\${offset}px\`;
            if (progress < 1) requestAnimationFrame(scrollStep);
          }
          requestAnimationFrame(scrollStep);
        })
        .catch(err => {
          bodyMain.innerHTML = "<div class='entry'>‚ùå Failed to load permits</div>";
          console.error("Permit JSON load error:", err);
        });
    }

    window.onload = function () {
      rotateCards();
    };
  </script>
</body>
</html>
