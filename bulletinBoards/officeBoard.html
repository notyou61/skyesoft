<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<title>Office Bulletin Board</title>
<link rel="icon" href="/skyesoft/assets/images/favicon.ico" type="image/x-icon">

<style>
/* ‚Äî‚Äî‚Äî [ unchanged styling from your version ] ‚Äî‚Äî‚Äî */
* { box-sizing: border-box; margin: 0; padding: 0; }
html, body {
  height: 100vh;
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  background: url('/skyesoft/assets/images/background.jpg') no-repeat center center fixed;
  background-size: cover;
  display: flex;
  flex-direction: column;
  align-items: center;
}
.board-section {
  width: 90vw; max-width: 1200px; background: #fff;
  border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.1);
  padding: 8px 16px;
}
#pageHeader, #pageFooter { flex-shrink: 0; }
#pageBody {
  flex-grow: 1; display: flex; flex-direction: column;
  justify-content: space-between; margin: 12px 0;
  max-height: calc(100vh - 160px); overflow: hidden;
}
#pageHeader {
  display: flex; justify-content: space-between;
  align-items: center; font-size: 1.1em; margin-top: 12px;
}
.bodyHeader, .bodyFooter {
  font-weight: bold; font-size: 1em; text-align: left; margin-bottom: 8px;
}
.bodyHeader::after {
  content: ""; display: block; height: 2px; width: 100%;
  background: #ccc; margin-top: 6px; margin-bottom: 0px;
}
.cardBody { overflow-y: auto; max-height: 60vh; flex-grow: 1; }
.version { font-size: 0.8em; color: #777; }
.forecastRow {
  display: flex; justify-content: space-between; gap: 12px; flex-wrap: wrap;
}
.forecastItem { flex: 1; font-size: 0.8rem; min-width: 200px; }
</style>
</head>

<body>

<!-- HEADER -->
<div class="board-section" id="pageHeader">
  <div style="display: flex; align-items: center; gap: 16px;">
    <img alt="Christy Signs"
      src="/skyesoft/assets/images/christyLogo.png"
      style="max-height: 48px;">
    <h1 style="font-size: 1.4em; white-space: nowrap;">Office Bulletin Board</h1>
  </div>

  <div style="display: flex; flex-direction: column; align-items: flex-end; font-size: 0.9em;">
    <div>üå¶Ô∏è Weather: <span id="weatherDisplay">Loading...</span></div>
    <div>‚è∞ Time: <span id="currentTime">--:--:--</span></div>
    <div>üïí Interval Remaining: <span id="intervalRemainingData">Loading...</span></div>
  </div>
</div>

<!-- BODY -->
<div class="board-section" id="pageBody">
  <div class="bodyHeader" id="bodyHeader"></div>
  <div id="bodyMain"></div>
  <div class="bodyFooter" id="bodyFooter"></div>
</div>

<!-- FOOTER -->
<div class="board-section" id="pageFooter">
  <div>¬© 2025 Maychris Corporation</div>
  <div class="version">Loading version...</div>
</div>

<!-- Confetti Include -->
<script src="/skyesoft/assets/js/confetti.js"></script>

<script>
/* CARD SYSTEM ‚Äî UNCHANGED */
const cards = [
  /* your Active Permits card */
  /* your Today‚Äôs Highlights card */
  /* your KPI Dashboard card */
  /* your Announcements card */
]; // ‚Üê your exact card objects remain untouched

let currentCardIndex = 0;

function populateCard({header, body, footer}) {
  document.getElementById("bodyHeader").innerHTML = header || "";
  document.getElementById("bodyMain").innerHTML = `<div class="cardBody">${body || ""}</div>`;
  document.getElementById("bodyFooter").innerHTML = footer || "";
}

function rotateCards() {
  const card = cards[currentCardIndex];
  populateCard(card);
  currentCardIndex = (currentCardIndex + 1) % cards.length;
  setTimeout(rotateCards, card.duration || 15000);
}
</script>

<!-- üîµ SSE LIVE DATA -->
<script>
const evtSource = new EventSource("/skyesoft/api/getDynamicData.php");

evtSource.onmessage = (event) => {
  const sse = JSON.parse(event.data);

  // ‚è∞ Time
  const time = sse.timeDateArray?.currentLocalTime;
  if (time) document.getElementById("currentTime").textContent = time;

  // üå¶Ô∏è Weather
  const wx = sse.weatherData;
  if (wx) {
    document.getElementById("weatherDisplay").textContent = `${wx.temp}¬∞F ‚Äî ${wx.description}`;
    if (document.getElementById("sunriseTime")) document.getElementById("sunriseTime").textContent = wx.sunrise;
    if (document.getElementById("sunsetTime")) document.getElementById("sunsetTime").textContent = wx.sunset;
    if (document.getElementById("daylightTime")) document.getElementById("daylightTime").textContent = wx.daytimeHours;
    if (document.getElementById("nightTime")) document.getElementById("nightTime").textContent = wx.nighttimeHours;
  }

  // üïí Interval
  const rem = sse.intervalsArray?.secondsRemainingToInterval;
  if (rem !== undefined) {
    const h = Math.floor(rem/3600), m = Math.floor((rem%3600)/60), s = rem%60;
    document.getElementById("intervalRemainingData").textContent = `${h}h ${m}m ${s}s`;
  }
};
</script>

<!-- üå§Ô∏è NWS FORECAST -->
<script>
async function updateForecast() {
  try {
    const lat = 33.4484, lon = -112.0740; // Phoenix
    const pt = await fetch(`https://api.weather.gov/points/${lat},${lon}`);
    const grid = await pt.json();
    const fx = await fetch(grid.properties.forecast);
    const data = await fx.json();
    const days = data.properties.periods.filter(p => p.isDaytime).slice(0,3);

    days.forEach((p,i) => {
      const el = document.getElementById(`forecastDay${i+1}`);
      if (el) el.innerHTML =
        `<strong>${p.name}</strong><br>
         ${p.shortForecast}<br>
         High ${p.temperature}¬∞F`;
    });

  } catch { console.warn("Forecast unavailable"); }
}

setInterval(updateForecast, 86400000);
updateForecast();
</script>

<!-- VERSION + CARD ROTATION INIT -->
<script>
document.addEventListener("DOMContentLoaded", () => {
  fetch("/home/notyou64/public_html/data/version.json")
    .then(r => r.json()).then(v => {
      document.querySelector(".version").textContent = v.version || "";
    });

  rotateCards();
});
</script>

</body>
</html>
